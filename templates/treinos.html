{% extends 'base.html' %}

{% block title %} Treinos de {{ cliente.nome }} | {{ nome_sistema }} {% endblock %}

{% block content %}
    <h2>üèãÔ∏è Treinos de {{ cliente.nome }}</h2>
    <a href="{{ url_for('index') }}" class="button-link" style="background-color: var(--secondary-color);">Voltar para Clientes</a>

    {% if cliente.treinos %}
    <div style="margin-top: 20px; padding: 10px; border-bottom: 1px solid #ddd; display: flex; align-items: center; gap: 10px;">
        <strong>Visualizar Treino:</strong>
        {% for nome, treino in cliente.treinos.items() %}
            <a href="{{ url_for('treinos', cliente_id=cliente.id, nome_treino_selecionado=nome) }}" 
               class="button-link" 
               style="background-color: {% if nome == treino_atual %}var(--primary-color){% else %}var(--secondary-color){% endif %}; padding: 5px 10px;">
                {{ nome }}
            </a>
        {% endfor %}
    </div>
    {% endif %}

    {% if treino_atual %}
    <h3 style="margin-top: 20px;">Treino Atual: {{ treino_atual }}</h3>
    <table cellpadding="10" cellspacing="0">
        <thead>
            <tr>
                <th>Imagem</th>
                <th>Exerc√≠cio</th>
                <th>S√©ries</th>
                <th>Repeti√ß√µes</th>
                <th>Carga/Obs</th>
                {% if perfil in ['professor', 'admin'] %}
                <th>A√ß√£o</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for exercicio in cliente.treinos[treino_atual] %}
            <tr>
                <td>
                    <img src="{{ url_for('static', filename='images/' + imagens_exercicios.get(exercicio.nome, 'default.jpg')) }}" 
                         alt="{{ exercicio.nome }}" 
                         class="exercise-img">
                </td>
                <td>{{ exercicio.nome }}</td>
                <td>{{ exercicio.series }}</td>
                <td>{{ exercicio.reps }}</td>
                <td>{{ exercicio.carga }}</td>
                {% if perfil in ['professor', 'admin'] %}
                <td>
                    <form method="POST" action="{{ url_for('treinos', cliente_id=cliente.id, nome_treino_selecionado=treino_atual) }}" style="display:inline;">
                        <input type="hidden" name="remover_exercicio_index" value="{{ loop.index0 }}">
                        <input type="hidden" name="treino_alvo" value="{{ treino_atual }}">
                        <button type="submit" onclick="return confirm('Remover {{ exercicio.nome }}?');" class="button-action" style="color: var(--error-color); background: none; border: none; cursor: pointer; padding: 0;">‚ùå</button>
                    </form>
                </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="margin-top: 20px;">Nenhum treino cadastrado para este cliente.</p>
    {% endif %}


    {% if perfil in ['professor', 'admin'] %}
    <div style="border: 1px solid #ccc; padding: 20px; border-radius: 8px; margin-top: 30px;">
        <h3>Adicionar Exerc√≠cio</h3>
        <form method="POST" action="{{ url_for('treinos', cliente_id=cliente.id) }}">
            <label for="nome_treino">Nome do Treino (Ex: A, B, C):</label>
            <input type="text" id="nome_treino" name="nome_treino" required>

            <label for="nome_exercicio">Exerc√≠cio:</label>
            <select id="nome_exercicio" name="nome_exercicio" required>
                {% for ex in exercicios_cadastrados %}
                    <option value="{{ ex }}">{{ ex }}</option>
                {% endfor %}
            </select>

            <div style="display: flex; gap: 15px;">
                <div style="flex-grow: 1;">
                    <label for="series">S√©ries:</label>
                    <input type="number" id="series" name="series" value="3" required>
                </div>
                <div style="flex-grow: 1;">
                    <label for="reps">Repeti√ß√µes/Tempo:</label>
                    <input type="text" id="reps" name="reps" value="10-12" required>
                </div>
                <div style="flex-grow: 1;">
                    <label for="carga">Carga/Observa√ß√£o:</label>
                    <input type="text" id="carga" name="carga" placeholder="Ex: 20kg ou 'Foco na execu√ß√£o'">
                </div>
            </div>
            <button type="submit">Adicionar ao Treino</button>
        </form>
    </div>
    {% endif %}
{% endblock %}